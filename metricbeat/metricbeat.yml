metricbeat.config.modules:
  path: ${path.config}/modules.d/*.yml
  reload.enabled: true
  reload.period: 10s

metricbeat.modules:
  # Мониторинг системы
  - module: system
    metricsets:
      - cpu
      - load
      - memory
      - network
      - process
      - process_summary
      - socket_summary
    enabled: true
    period: 10s
    processes: ['.*']
    cpu.metrics: [percentages, normalized_percentages]
    core.metrics: [percentages]

  # Мониторинг дисков
  - module: system
    metricsets:
      - filesystem
      - diskio
    enabled: true
    period: 1m

  # Мониторинг Docker
  - module: docker
    metricsets:
      - container
      - cpu
      - diskio
      - healthcheck
      - info
      - memory
      - network
    hosts: ["unix:///var/run/docker.sock"]
    enabled: true
    period: 10s

# Настройка вывода в Elasticsearch
output.elasticsearch:
  hosts: ["elasticsearch:9200"]
  indices:
    - index: "metricbeat-%{+yyyy.MM.dd}"
      when.equals:
        metricset.module: "system"
    - index: "metricbeat-docker-%{+yyyy.MM.dd}"
      when.equals:
        metricset.module: "docker"

# Настройки для Docker
logging.json: true
logging.metrics.enabled: false
